app.filter("daterangetech",(function(){return function(conversations,start_date,end_date){var result=[],start_date=start_date&&!isNaN(Date.parse(start_date))?Date.parse(start_date):0,end_date=end_date&&!isNaN(Date.parse(end_date))?Date.parse(end_date):(new Date).getTime();if(start_date>end_date)alert("Check Input Date"),location.reload();else if(conversations&&conversations.length>0)return $.each(conversations,(function(index,conversation){var conversationDate=new Date(conversation.approvals_adate_s);conversationDate>=start_date&&conversationDate<=end_date&&result.push(conversation)})),result}})),app.filter("apstatusfilter",(function(){return function(approvals_status){switch(approvals_status){case"A":return"A - approval not released";case"B":return"B - approval not released";default:return"-"}}})),app.controller("ctrl_techapprovalsrpt",(function($scope,$http,$filter){$scope.showhidesfilters=function(ids){$("#"+ids).hasClass("lis_sh")?$("#"+ids).removeClass("lis_sh"):$("#"+ids).addClass("lis_sh")},mdata=[],$scope.isloading=!0,document.getElementById("rpt_project_tech").style.background="#e84a5f",localStorage.removeItem("rpt_techapprovals"),$("#back_btn").on("click",(function(){window.history.back()})),get_all();var bc_home=document.getElementById("back-to-tops");bc_home.addEventListener("click",(function(){window.scrollTo(0,0)}));var fi=document.getElementById("fiexdheader-hide");function get_all(){let post_data={naf_user:userinfo};$http({method:"POST",data:post_data,url:api_url+"Approvals/index.php"}).then((function(res){console.log(res.data),"1"===res.data.msg&&($scope.data=res.data.data,mdata=res.data.data,$scope.isloading=!1)}))}function noSubFilter(obj){for(var key in $scope.isloading=!0,obj)if(obj[key])return!1;return $scope.isloading=!1,!0}bc_home.style.display="none",window.addEventListener("scroll",(function(){pageYOffset>400?bc_home.style.display="block":bc_home.style.display="none"})),$scope.filter={},$scope.getItems=(obj,array)=>($scope.isloading=!0,(array||[]).map(w=>w[obj]).filter((w,idx,arr)=>void 0!==w&&($scope.isloading=!1,arr.indexOf(w)===idx))),$scope.filterByPropertiesMatchingAND=function(data){$scope.isloading=!0;var matchesAND=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if(!$scope.filter[obj][data[obj]]){matchesAND=!1;break}}return $scope.isloading=!1,matchesAND},$scope.filterByPropertiesMatchingOR=function(data){$scope.isloading=!0;var matchesOR=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if($scope.filter[obj][data[obj]]){matchesOR=!0;break}matchesOR=!1}return $scope.isloading=!1,matchesOR},$scope.srtbydate=()=>{var sdate,spdate=$("#sdate").val().split("-"),s_d=spdate[0],s_m=spdate[1],s_y,ssdate=spdate[2]+"-"+s_m+"-"+s_d,edate,epdate=$("#edate").val().split("-"),e_d=epdate[0],e_m=epdate[1],e_y,esdate=epdate[2]+"-"+e_m+"-"+e_d;console.log(ssdate,esdate),$scope.data=$filter("daterangetech")(mdata,ssdate,esdate)},$scope.printclick=function(){var tbl=document.getElementById("techapprovals").innerHTML;localStorage.removeItem("rpt_techapprovals"),localStorage.setItem("rpt_techapprovals",tbl),window.open(print_location+"rpt/rpt_technicalapprovals.php","_blank")}})),app.filter("myDatefilter",(function(){return function(myDatefilter){switch(myDatefilter){case"-":return"";default:return"d-MM-YYYY"}}})),app.controller("ctrl_drawingapprovals",["$scope","$http",function($scope,$http){var hei=document.querySelector("#hidiv").offsetHeight;if(console.log(screen.width),screen.width<1300)var nwtop=83+parseInt(hei)-1;else var nwtop=70+parseInt(hei)-1;console.log(hei,nwtop),console.log(hei.offsetTop+hei.offsetLeft);const xshorts=document.querySelectorAll(".fiexdheader-sort");xshorts.forEach(x=>{x.style.top=nwtop+"px"});var bc_home=document.getElementById("back-to-tops");function rptview(){let post_data={naf_user:userinfo};$http({method:"POST",data:post_data,url:api_url+"DrawingApprovals/rpt.php"}).then((function(res){"1"===res.data.msg?(console.log(res.data.data),$scope._approvals=res.data.data):alert(res.data.data),$scope.isloading=!1}))}function get_projectinfo(){let post_data={naf_user:userinfo};var req;$http.post(api_url+"Project/index.php",post_data).then(res=>{"1"===res.data.msg?$scope.viewproject=res.data.data:alert(res.data.data)})}bc_home.addEventListener("click",(function(){window.scrollTo(0,0)})),bc_home.style.display="none",window.addEventListener("scroll",(function(){pageYOffset>400?bc_home.style.display="block":bc_home.style.display="none"})),$scope.$on("loaded",(function(){console.log("all ok")})),$scope.isloading=!0,document.getElementById("rpt_project_drawing").style.background="#e84a5f",$("#back_btn").on("click",(function(){window.history.back()})),rptview(),get_projectinfo(),$scope._fview="0";var i=0;$scope.hidedetials=function(){1===i?(i=0,document.getElementById("hidebutton").innerText="Show Details",$scope._fview="0"):(i=1,$scope._fview="1",document.getElementById("hidebutton").innerText="Hide Details")},$scope.print_btn=function(){var tab=document.getElementById("draw_approvals").innerHTML;localStorage.removeItem("rpt_techapprovals"),localStorage.setItem("rpt_techapprovals",tab),window.open(print_location+"rpt/rpt_technicalapprovals.php","_blank")}}]),app.filter("daterangevariations",(function(){return function(conversations,start_date,end_date){var result=[],start_date=start_date&&!isNaN(Date.parse(start_date))?Date.parse(start_date):0,end_date=end_date&&!isNaN(Date.parse(end_date))?Date.parse(end_date):(new Date).getTime();if(conversations&&conversations.length>0)return $.each(conversations,(function(index,conversation){var conversationDate=new Date(conversation.sdate);conversationDate>=start_date&&conversationDate<=end_date&&result.push(conversation)})),result}})),app.controller("ctrl_variationsrpt",["$scope","$http","$filter",function($scope,$http,$filter){$scope.showhidesfilters=function(ids){$("#"+ids).hasClass("lis_sh")?$("#"+ids).removeClass("lis_sh"):$("#"+ids).addClass("lis_sh")},$scope.isloading=!0,document.getElementById("rpt_variation").style.background="#e84a5f",$("#back_btn").on("click",(function(){window.history.back()}));var bc_home=document.getElementById("back-to-tops");function getRpt(){let post_data={naf_user:userinfo};$http({method:"post",url:api_url+"Variations/rpt.php",data:post_data}).then((function(res){console.log(res.data),"1"===res.data.msg?($scope.data=res.data.data,mdata=res.data.data):alert(res.data.data),$scope.isloading=!1}))}function noSubFilter(obj){for(var key in $scope.isloading=!0,obj)if(obj[key])return!1;return $scope.isloading=!1,!0}bc_home.addEventListener("click",(function(){window.scrollTo(0,0)})),bc_home.style.display="none",window.addEventListener("scroll",(function(){pageYOffset>400?(console.log("owk"),bc_home.style.display="block"):(console.log("error"),bc_home.style.display="none")})),localStorage.removeItem("rpt_variation_tbl"),getRpt(),mdata=[],$scope.filter={},$scope.getItems=(obj,array)=>($scope.isloading=!0,(array||[]).map(w=>w[obj]).filter((w,idx,arr)=>void 0!==w&&($scope.isloading=!1,arr.indexOf(w)===idx))),$scope.filterByPropertiesMatchingAND=function(data){$scope.isloading=!0;var matchesAND=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if(!$scope.filter[obj][data[obj]]){matchesAND=!1;break}}return $scope.isloading=!1,matchesAND},$scope.filterByPropertiesMatchingOR=function(data){$scope.isloading=!0;var matchesOR=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if($scope.filter[obj][data[obj]]){matchesOR=!0;break}matchesOR=!1}return $scope.isloading=!1,matchesOR},$scope.srtbydate=()=>{var sdate,spdate=$("#sdate").val().split("-"),s_d=spdate[0],s_m=spdate[1],s_y,ssdate=spdate[2]+"-"+s_m+"-"+s_d,edate,epdate=$("#edate").val().split("-"),e_d=epdate[0],e_m=epdate[1],e_y,esdate=epdate[2]+"-"+e_m+"-"+e_d;console.log(ssdate,esdate),$scope.data=$filter("daterangevariations")(mdata,ssdate,esdate)}}]),app.filter("varstatusfilter",(function(){return function(variation_status){switch(variation_status){case"1":return"ISSUED FOR APPROVAL";case"2":return"APPROVED";case"3":return"cancelled";case"4":return"dummy";default:return"-"}}})),app.filter("daterangecuttinglist",(function(){return function(conversations,start_date,end_date){var result=[],start_date=start_date&&!isNaN(Date.parse(start_date))?Date.parse(start_date):0,end_date=end_date&&!isNaN(Date.parse(end_date))?Date.parse(end_date):(new Date).getTime();if(conversations&&conversations.length>0)return $.each(conversations,(function(index,conversation){var conversationDate=new Date(conversation.cuttinglist_cldaterelease_s);conversationDate>=start_date&&conversationDate<=end_date&&result.push(conversation)})),result}})),app.controller("ctrl_cuttinglistrpt",(function($scope,$http,$filter){function noSubFilter(obj){for(var key in $scope.isloading=!0,obj)if(obj[key])return!1;return $scope.isloading=!1,!0}function load_Rtp(){let post_data={naf_user:userinfo};$http.post(api_url+"cuttinglist/rpt.php",post_data).then(res=>{console.log(res.data),"1"===res.data.msg?($scope.data=res.data.data,mdata=res.data.data):alert(res.data.data),$scope.isloading=!1})}mdata=[],$scope.showhidesfilters=function(ids){$("#"+ids).hasClass("lis_sh")?$("#"+ids).removeClass("lis_sh"):$("#"+ids).addClass("lis_sh")},$scope.filter={},$scope.getItems=(obj,array)=>($scope.isloading=!0,(array||[]).map(w=>w[obj]).filter((w,idx,arr)=>void 0!==w&&($scope.isloading=!1,arr.indexOf(w)===idx))),$scope.filterByPropertiesMatchingAND=function(data){$scope.isloading=!0;var matchesAND=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if(!$scope.filter[obj][data[obj]]){matchesAND=!1;break}}return $scope.isloading=!1,matchesAND},$scope.filterByPropertiesMatchingOR=function(data){$scope.isloading=!0;var matchesOR=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if($scope.filter[obj][data[obj]]){matchesOR=!0;break}matchesOR=!1}return $scope.isloading=!1,matchesOR},$scope.isloading=!0,document.getElementById("rpt_project_cuttinglist").style.background="#e84a5f",$("#back_btn").on("click",(function(){window.history.back()})),load_Rtp(),$scope.printclick=function(){console.log("its working");var tbl=document.getElementById("cuttinglist").innerHTML;localStorage.removeItem("rpt_variation_tbl"),localStorage.setItem("rpt_variation_tbl",tbl),window.open(print_location+"rpt/rpt_variations.php","_blank")},$scope.srtbydate=()=>{var sdate,spdate=$("#sdate").val().split("-"),s_d=spdate[0],s_m=spdate[1],s_y,ssdate=spdate[2]+"-"+s_m+"-"+s_d,edate,epdate=$("#edate").val().split("-"),e_d=epdate[0],e_m=epdate[1],e_y,esdate=epdate[2]+"-"+e_m+"-"+e_d;console.log(ssdate,esdate),$scope.data=$filter("daterangecuttinglist")(mdata,ssdate,esdate)}})),app.filter("daterangeglassorders",(function(){return function(conversations,start_date,end_date){var result=[],start_date=start_date&&!isNaN(Date.parse(start_date))?Date.parse(start_date):0,end_date=end_date&&!isNaN(Date.parse(end_date))?Date.parse(end_date):(new Date).getTime();if(conversations&&conversations.length>0)return $.each(conversations,(function(index,conversation){var conversationDate=new Date(conversation.releasedtopurchase_s);conversationDate>=start_date&&conversationDate<=end_date&&result.push(conversation)})),result}})),app.controller("ctrl_glassordersrpt",(function($scope,$http,$filter){function noSubFilter(obj){for(var key in $scope.isloading=!0,obj)if(obj[key])return!1;return $scope.isloading=!1,!0}function rpt(){let post_data={naf_user:userinfo};$http.post(api_url+"glassorder/rpt.php",post_data).then(res=>{console.log(res.data),"1"===res.data.msg?($scope.data=res.data.data,mdata=res.data.data):alert(res.data.data),$scope.isloading=!1})}mdata=[],$scope.showhidesfilters=function(ids){$("#"+ids).hasClass("lis_sh")?$("#"+ids).removeClass("lis_sh"):$("#"+ids).addClass("lis_sh")},$scope.filter={},$scope.getItems=(obj,array)=>($scope.isloading=!0,(array||[]).map(w=>w[obj]).filter((w,idx,arr)=>void 0!==w&&($scope.isloading=!1,arr.indexOf(w)===idx))),$scope.filterByPropertiesMatchingAND=function(data){$scope.isloading=!0;var matchesAND=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if(!$scope.filter[obj][data[obj]]){matchesAND=!1;break}}return $scope.isloading=!1,matchesAND},$scope.filterByPropertiesMatchingOR=function(data){$scope.isloading=!0;var matchesOR=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if($scope.filter[obj][data[obj]]){matchesOR=!0;break}matchesOR=!1}return $scope.isloading=!1,matchesOR},$scope.isloading=!0,document.getElementById("rpt_project_glassorders").style.background="#e84a5f",$("#back_btn").on("click",(function(){window.history.back()})),rpt(),$scope.printclick=function(){console.log("its working");var tbl=document.getElementById("cuttinglist").innerHTML;localStorage.removeItem("rpt_variation_tbl"),localStorage.setItem("rpt_variation_tbl",tbl),window.open(print_location+"rpt/rpt_variations.php","_blank")},$scope.srtbydate=()=>{var sdate,spdate=$("#sdate").val().split("-"),s_d=spdate[0],s_m=spdate[1],s_y,ssdate=spdate[2]+"-"+s_m+"-"+s_d,edate,epdate=$("#edate").val().split("-"),e_d=epdate[0],e_m=epdate[1],e_y,esdate=epdate[2]+"-"+e_m+"-"+e_d;console.log(ssdate,esdate),$scope.data=$filter("daterangeglassorders")(mdata,ssdate,esdate)}})),app.filter("glassstatusfilter",(function(){return function(orderstatus){var st="ORDERED";switch(orderstatus){case"1":st="ORDERED";break;case"2":st="PENDING";break;case"3":st="HOLD";break;case"4":st="CANCELLED";break;case"5":st="SUPERSEDED";break;case"6":st="Others"}return st}})),app.controller("ctrl_drawingapprovals1",["$scope","$http","$filter",function($scope,$http,$filter){$scope.isloading=!0,$mdata=[],$("#back_btn").on("click",(function(){window.history.back()}));var bc_home=document.getElementById("back-to-tops");function rptview(){let post_data={naf_user:userinfo};$http({method:"POST",data:post_data,url:api_url+"DrawingApprovals/rpt1.php"}).then((function(res){console.log(res.data),"1"===res.data.msg?(console.log(res.data.data),$scope.data=res.data.data,mdata=res.data.data):alert(res.data.data),$scope.isloading=!1}))}function noSubFilter(obj){for(var key in $scope.isloading=!0,obj)if(obj[key])return!1;return $scope.isloading=!1,!0}bc_home.addEventListener("click",(function(){window.scrollTo(0,0)})),bc_home.style.display="none",window.addEventListener("scroll",(function(){pageYOffset>400?bc_home.style.display="block":bc_home.style.display="none"})),document.getElementById("rpt_project_drawing").style.background="#e84a5f",rptview(),$scope.filter={},$scope.getItems=(obj,array)=>($scope.isloading=!0,(array||[]).map(w=>w[obj]).filter((w,idx,arr)=>void 0!==w&&($scope.isloading=!1,arr.indexOf(w)===idx))),$scope.filterByPropertiesMatchingAND=function(data){$scope.isloading=!0;var matchesAND=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if(!$scope.filter[obj][data[obj]]){matchesAND=!1;break}}return $scope.isloading=!1,matchesAND},$scope.filterByPropertiesMatchingOR=function(data){$scope.isloading=!0;var matchesOR=!0;for(var obj in $scope.filter)if($scope.filter.hasOwnProperty(obj)){if(noSubFilter($scope.filter[obj]))continue;if($scope.filter[obj][data[obj]]){matchesOR=!0;break}matchesOR=!1}return $scope.isloading=!1,matchesOR},$scope.print_btn=function(){var tab=document.getElementById("draw_approvals").innerHTML;localStorage.removeItem("rpt_techapprovals"),localStorage.setItem("rpt_techapprovals",tab),window.open(print_location+"rpt/rpt_technicalapprovals.php","_blank")},$scope.showhidesfilters=function(ids){$("#"+ids).hasClass("lis_sh")?$("#"+ids).removeClass("lis_sh"):$("#"+ids).addClass("lis_sh")},$scope.Revision_btnList=function($x){console.log($x),$scope._drawingno=$x.approvals_draw_no,document.getElementById("revision_list").style.display="block";let post_data={naf_user:userinfo,project_no:$x.approvals_project_code,drawing_no:$x.approvals_token};$http.post(api_url+"DrawingApprovals/getAllrevisions.php",post_data).then((function(res){console.log(res.data),"1"===res.data.msg?$scope.revision_list=res.data.data:alert(res.data.data)}))},$scope.srtbydate=()=>{var sdate,spdate=$("#sdate").val().split("-"),s_d=spdate[0],s_m=spdate[1],s_y,ssdate=spdate[2]+"-"+s_m+"-"+s_d,edate,epdate=$("#edate").val().split("-"),e_d=epdate[0],e_m=epdate[1],e_y,esdate=epdate[2]+"-"+e_m+"-"+e_d;console.log(ssdate,esdate),$scope.data=$filter("daterange")(mdata,ssdate,esdate)}}]),app.filter("daterange",(function(){return function(conversations,start_date,end_date){var result=[],start_date=start_date&&!isNaN(Date.parse(start_date))?Date.parse(start_date):0,end_date=end_date&&!isNaN(Date.parse(end_date))?Date.parse(end_date):(new Date).getTime();if(conversations&&conversations.length>0)return $.each(conversations,(function(index,conversation){var conversationDate=new Date(conversation.approvals_infos_submitedon);conversationDate>=start_date&&conversationDate<=end_date&&result.push(conversation)})),result}})),app.filter("myfilter",(function($filter){return function(items,from,to){return $filter("filter")(items,"approvals_infos_submitedon",(function(v){var date=moment(v);return date>=moment(from)&&date<=moment(to)}))}})),app.filter("myfi2",(function(){return function(approvals_last_status){switch(approvals_last_status){case"A":return"A - Approved";case"B":return"B - Approved As noted";case"C":return"C - Approved as noted Resubmit";case"H":return"H - ON Hold";case"U":return"U - Under Review";case"X":return"X - Canceled";case"F":return"F - FOR INFORMATION";default:return"- Pending"}}}));