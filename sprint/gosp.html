<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Project Reserved materials</title>
        <link rel="stylesheet" href="./css/font.css">
        <style>
        * {
            font-size: 0.85rem;
            font-family: 'owh';

        }
       body{
        zoom:120%;
       }
        
        table {
            width: auto;
            margin: 1px auto;
            border: 1px solid #000;
            border-collapse: collapse;
            

        }
        .noonprint{
            position: sticky;
    top: 0;
    background: #fff;
    padding: 10px;
        }
        table th,
        table td {
            border: 1px solid #000;
            padding: 3px;
        }

        .theader {
            background-color: #efefef;

        }
        @media print{
            body{
                width : auto;
                margin: 0.39in 0.39in 0.75in 0.39in;
            }
            table{
                zoom: 85%;
            }
            .noonprint{
                display:none;
            }
        }
        @page {
            size:auto ;
            margin: 0.39in 0.39in 0.75in 0.39in;
            /* margin: 27mm 16mm 27mm 16mm; */
        }
        </style>

    </head>
    <body>
        <div class="noonprint">
            <div>
                Group By
                <select id="groupby">
                    <option value>-</option>
                    <option value="goprojectname">Project</option>
                    <option value="goglassspec">Specification</option>
                    <option value="goglasstype">Glass Type</option>
                    <option value="procurement_coating">Coatting</option>
                    <option value="procurement_thickness">Thickness</option>
                    <option value="goreceipttype">Order Type</option>
                    <option value="gomarking">Marking</option>
                    <option value="godoneby">Engineer</option>
                    <option value="procurement_supplier">Supplier</option>
                </select>
                <input type="text" id="print_titlex"
                    placeholder="Enter Title" style="display: none;" />
                <button type="button" id="rptload">Load Report</button>
                <button type="button" id="summaryload">Load Summary</button>
                <button onclick="window.print()">Print</button>
                <button id="exportexcel" class="ism-btns btn-normal">
                    Export Excel
                </button>
            </div>
            <!-- <div>
                <div>
                    <button type="button" id="allbtn" onclick="changeMode('1')">All</button>
                    <button type="button" id="instockbtn"
                        onclick="changeMode('2')">IN-Stock</button>
                    <button type="button" id="reseverbtn"
                        onclick="changeMode('3')">Reserved</button>
                </div>
            </div> -->
        </div>
        <div id="maincontent">

        </div>
        <script src="./../themes/loginscreen/vendor/jquery/jquery-3.2.1.min.js"></script>
        
        <script
            src="./../Dashboard/Main/excelnn.js"></script>
        <script>
            let groupby = document.getElementById("groupby");
            const filters = {
                'goprojectname' : "PROJECT WISE",
                'goglassspec'  : 'SPECIFICATION WISE',
                'goglasstype' : 'GLASS TYPE WISE',
                'procurement_coating' : 'COATTING WISE',
                'procurement_thickness' : 'THICKNESS WISE',
                'procurement_thickness' : 'THICKNESS WISE',
                'goreceipttype' : "GLASS ORDER TYPE",
                'gomarking' : 'MARKING',
                'godoneby' : "ENGINEER WISE",
                'procurement_supplier' : "SUPPLIER WISE"
            }

            //summary 
            let data = [];
            let gdata = [];          
            let cols = {};
            let gtotqty = 0;
            let gtotarea = 0;
            let grecqty = 0;
            let grecarea = 0;
            let gbalqty = 0;
            let gbalarea = 0;
            let gtotprice = 0;
            let gorupbytitle = "";
            
            function GTotal(){
                gtotqty = data.reduce((r,j)=> r + (+j.procurement_qty),0);
                gtotarea = data.reduce((r,j)=> r + (+j.procurement_area),0);
                grecqty = data.reduce((r,j)=> r + (+j.receipt_qty),0);
                grecarea = data.reduce((r,j)=> r + (+j.receipt_area),0);
                gbalqty = data.reduce((r,j)=> r + (+j.go_balance_qty),0);
                gbalarea = data.reduce((r,j)=> r + (+j.go_balance_area),0);
                gtotprice = data.reduce((r,j)=> r + (+j.procurement_totalprice),0);
            }
            //make data group by
            function _groupdata(){
                const gby = groupby.value;
                gorupbytitle = filters[gby]
                console.log(gorupbytitle);
                gdata = [];
                let gnames = [];
                data.map(i=>{
                    const gname = i[gby].trim();
                    if(!gnames.includes(gname)){
                        gnames.push(gname);
                    }
                });

                gnames.map(i=>{
                    let x = {};
                    x['gbyname'] = i;
                    const datas = data.filter(y=> y[gby].trim() === i);
                    const totqty = datas.reduce((r,j)=> r + (+j.procurement_qty),0);
                    const totarea = datas.reduce((r,j)=> r + (+j.procurement_area),0);
                    const recqty = datas.reduce((r,j)=> r + (+j.receipt_qty),0);
                    const recarea = datas.reduce((r,j)=> r + (+j.receipt_area),0);
                    const balqty = datas.reduce((r,j)=> r + (+j.go_balance_qty),0);
                    const balarea = datas.reduce((r,j)=> r + (+j.go_balance_area),0);
                    const totprice = datas.reduce((r,j)=> r + (+j.procurement_totalprice),0);
                    x['totqty'] = totqty;
                    x['totarea'] = totarea;
                    x['recqty'] = recqty;
                    x['recarea'] = recarea;
                    x['balqty'] = balqty;
                    x['balarea'] = balarea;
                    x['totprice'] = totprice;
                    x['data'] = datas;
                    gdata.push(x);
                    
                })

                console.log(gdata);
            }
            window.onload = () => {
                let _data = localStorage.getItem("print_gosp_data");
                let _cols = localStorage.getItem("print_gosp_cols");
                //console.log(_data);
                data = JSON.parse(_data);
                cols = JSON.parse(_cols);
                GTotal();
                PrintNormal();
            }
            let rptload = document.getElementById('rptload');
            rptload.onclick = () => {
                const gbyval = groupby.value;
                if(gbyval === ''){
                    PrintNormal()
                }else{
                    _groupdata();
                    printbygroup();
                }
            }
            let summaryload = document.getElementById("summaryload");
            summaryload.onclick = () => {
                const gbyval = groupby.value;
                if(gbyval === ''){
                    alert("Try After Grouping Datas");
                    return;
                }
                printsummary();
            }
            groupby.onchange = () => {
                const gbyval = groupby.value;
                if(gbyval === ''){
                    PrintNormal()
                }else{
                    _groupdata();
                    printbygroup();
                }
            }
            //normal print no group
            function PrintNormal(){
                let pr = "";
                pr += ` <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th colspan="20"
                                    style="align-items: center;background-color: #ffffff;
                                border-right: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                ">
                                    <img load="lazy" src="./css/nafco_letter.png"
                                        style="width:90%;height: 88px;">
                                </th>
                            </tr>
                            <tr>
                                <th id="pagetitlex" colspan="15" style="font-size: 18px;
                                border-right: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-left: 1px solid transparent;
                            ">
                                    GLASS ORDER REPORT
                                </th>
                            </tr>
                        </thead>
                        </table>
                        <table style="width: 100%;">
                        <thead>
                            `
                pr += `<tr>`
                pr += `<td style="background:#f5f5f5;padding:9px">S.No</td>`;  
                if(cols?.odate){
                    pr += `<td style="background:#f5f5f5;padding:9px">Date</td>`;
                }
                if(cols?.otype){
                    pr += `<td style="background:#f5f5f5;padding:9px">Type</td>`;
                } 
                if(cols?.supplier){
                    pr += `<td style="background:#f5f5f5;padding:9px">Supplier</td>`;
                }
                if(cols?.coatting){
                    pr += `<td style="background:#f5f5f5;padding:9px">Coattings</td>`;
                }
                if(cols?.contract){
                    pr += `<td style="background:#f5f5f5;padding:9px">Contract#</td>`;
                }
                if(cols?.projectname){         
                    pr += `<td style="background:#f5f5f5;padding:9px">Project</td>`;
                }
                if(cols?.gono){        
                    pr += `<td style="background:#f5f5f5;padding:9px">Go#</td>`;
                }    
                if(cols?.pino){        
                    pr += `<td style="background:#f5f5f5;padding:9px">P.I</td>`;
                }    
                if(cols?.thikenss){
                pr += `<td style="background:#f5f5f5;padding:9px">Thickness</td>`;
                }
                if(cols?.outter){
                pr += `<td style="background:#f5f5f5;padding:9px">Outter</td>`;
                }
                if(cols?.inner){
                pr += `<td style="background:#f5f5f5;padding:9px">Inner</td>`;
                }
                if(cols?.qty){
                pr += `<td style="background:#f5f5f5;padding:9px">Qty</td>`;
                }
                if(cols?.qtyreceived){
                pr += `<td style="background:#f5f5f5;padding:9px">R.Qty</td>`;
                }                              
                if(cols?.qtybalance){
                pr += `<td style="background:#f5f5f5;padding:9px">B.Qty</td>`;
                }
                if(cols?.uinsert){
                pr += `<td style="background:#f5f5f5;padding:9px">U-Insert</td>`;
                }
                if(cols?.remarks){
                pr += `<td style="background:#f5f5f5;padding:9px">Remarks</td>`;
                }
                if(cols?.dlocation){
                pr += `<td style="background:#f5f5f5;padding:9px">Location</td>`;
                }
                if(cols?.eta){
                pr += `<td style="background:#f5f5f5;padding:9px">ETA</td>`;
                } 
                if(cols?.wkrno){
                pr += `<td style="background:#f5f5f5;padding:9px">Work order Ref#</td>`;
                } 
                if(cols?.area){
                pr += `<td style="background:#f5f5f5;padding:9px">SQM</td>`;
                }
                if(cols?.unitprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Unit Price</td>`;                
                } 
                if(cols?.otherprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Other Price</td>`;                
                }  
                if(+cols?.totalprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Total Price</td>`;                
                } 
                               
                
               
                        
                pr += `</tr> <tbody>`
                data.map((i,index)=>{
                    pr += `<tr key=${index}>`;
                        pr += `<td>${index+1}</td>`
                        if(cols?.odate){
                        pr += `<td>${i.procurement_orderdate_d.display}</td>`
                        }
                        if(cols?.otype){
                        pr += `<td>${i.goreceipttype}</td>`
                        }
                        if(cols?.supplier){
                        pr += `<td>${i.procurement_supplier}</td>`;
                        }
                        if(cols?.coatting){
                            pr += `<td>${i.procurement_coating}</td>`;
                        }
                        if(cols?.contract){
                            pr += `<td>${i.goproject}</td>`
                        }
                        if(cols?.projectname){     
                        pr += `<td>${i.goprojectname}</td>`
                        }
                        if(cols?.gono){   
                        pr += `<td>${i.gonodisp}</td>`
                        }      
                        if(cols?.pino){
                            pr += `<td>${i.invoiceno}</td>`
                        }                 
                        if(cols?.thikenss){
                            pr += `<td>${i.procurement_thickness}</td>`;
                        }                       
                        if(cols?.outter){
                            pr += `<td>${i.procurement_out}</td>`;
                        }
                        if(cols?.inner){
                            pr += `<td>${i.procurement_inner}</td>`;
                        }

                        if(cols?.qty){
                            pr += `<td style="text-align:center">${i.procurement_qty}</td>`;
                        }
                        if(cols?.qtyreceived){
                            pr += `<td style="text-align:center">${i.receipt_qty}</td>`;
                        }
                        if(cols?.qtybalance){
                            pr += `<td style="text-align:center">${i.go_balance_qty}</td>`;
                        }
                        if(cols?.uinsert){
                            pr += `<td style="text-align:center">${i.uinsert}</td>`;
                        }
                        if(cols?.remarks){ 
                            pr += `<td style="text-align:center">${i.procurementremark}</td>`;
                        }
                        if(cols?.dlocation){ 
                            pr += `<td style="text-align:center">${i.dellocation}</td>`;
                        }
                        if(cols?.eta){
                            pr += `<td>${i.procurement_orderdate}</td>`;
                        }
                        if(cols?.wkrno){ 
                            pr += `<td style="text-align:center">${i.workorderno}</td>`;
                        }

                        if(cols?.area){
                            pr += `<td style="text-align:center">${(+i.procurement_area).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }                       
                       
                        if(cols?.unitprice){
                            pr += `<td style="text-align:right">${(+i.procurment_orderunitprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;   
                        }  
                        if(cols?.otherprice){
                            pr += `<td style="text-align:right">${(+i.procurement_otherprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;             
                        }  
                        if(cols?.totalprice){
                            pr += `<td style="text-align:right">${(+i.procurement_totalprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }     

                    pr += `</tr>`;

                })
                //sum of table rows need
                
                pr += `<tr>`;
                        pr += `<td style="background: #fdffe5;"></td>`
                        if(cols?.odate){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.otype){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.supplier){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.coatting){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.contract){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.projectname){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.gono){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.pino){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.thikenss){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.outter){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.inner){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }                        
                        if(cols?.qty){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }                        
                        if(cols?.qtyreceived){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(grecqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }                        
                        if(cols?.qtybalance){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gbalqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.uinsert){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        } 
                        if(cols?.remarks){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }  
                        if(cols?.dlocation){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        } 
                        if(cols?.eta){
                            pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.wkrno){
                            pr += `<td style="background: #fdffe5;"></td>`;
                        }
                           
                        if(cols?.area){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        } 
                        if(cols?.unitprice){
                            pr += `<td style="background: #fdffe5;"></td>`;   
                        }  
                        if(cols?.otherprice){
                            pr += `<td style="background: #fdffe5;"></td>`;             
                        }  
                        if(cols?.totalprice){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }  
                pr += `<tr>`;
                //sum of table rows need end
                pr +=`</tbody></table>`;
                document.getElementById("maincontent").innerHTML = pr;
            }

            //group by print
            function printbygroup(){
                let pr = "";
                pr += ` <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th colspan="24"
                                    style="align-items: center;background-color: #ffffff;
                                border-right: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                ">
                                    <img load="lazy" src="./css/nafco_letter.png"
                                        style="width:90%;height: 88px;">
                                </th>
                            </tr>
                            <tr>
                                <td id="pagetitlex" colspan="28" style="font-size: 18px;
                                border-right: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-left: 1px solid transparent;
                            ">
                                    GLASS ORDER REPORT ${gorupbytitle}
                                </td>
                            </tr>
                        </thead>
                        </table>
                        <table style="width: 100%;">
                       
                            `
                
                gdata.map(x=>{
                    pr += `<thead><tr>`
                    pr += `<td style="background:#f5f5f5;padding:9px"> S.No </td>`;                
                  
                if(cols?.odate){
                    pr += `<td style="background:#f5f5f5;padding:9px">Date</td>`;
                }
                if(cols?.otype){
                    pr += `<td style="background:#f5f5f5;padding:9px">Type</td>`;
                } 
                if(cols?.supplier){
                    pr += `<td style="background:#f5f5f5;padding:9px">Supplier</td>`;
                }
                if(cols?.coatting){
                    pr += `<td style="background:#f5f5f5;padding:9px">Coattings</td>`;
                }
                if(cols?.contract){
                    pr += `<td style="background:#f5f5f5;padding:9px">Contract#</td>`;
                }
                if(cols?.projectname){         
                    pr += `<td style="background:#f5f5f5;padding:9px">Project</td>`;
                }
                if(cols?.gono){        
                    pr += `<td style="background:#f5f5f5;padding:9px">Go#</td>`;
                }    
                if(cols?.pino){        
                    pr += `<td style="background:#f5f5f5;padding:9px">P.I</td>`;
                }    
                if(cols?.thikenss){
                pr += `<td style="background:#f5f5f5;padding:9px">Thickness</td>`;
                }
                if(cols?.outter){
                pr += `<td style="background:#f5f5f5;padding:9px">Outter</td>`;
                }
                if(cols?.inner){
                pr += `<td style="background:#f5f5f5;padding:9px">Inner</td>`;
                }
                if(cols?.qty){
                pr += `<td style="background:#f5f5f5;padding:9px">Qty</td>`;
                }
                if(cols?.qtyreceived){
                pr += `<td style="background:#f5f5f5;padding:9px">R.Qty</td>`;
                }
                if(cols?.goglassspec){
                    pr += `<td style="background:#f5f5f5;padding:9px">Specification</td>`;
                }               
                if(cols?.qtybalance){
                pr += `<td style="background:#f5f5f5;padding:9px">B.Qty</td>`;
                }
                if(cols?.uinsert){
                pr += `<td style="background:#f5f5f5;padding:9px">U-Insert</td>`;
                }
                if(cols?.remarks){
                pr += `<td style="background:#f5f5f5;padding:9px">Remarks</td>`;
                }
                if(cols?.dlocation){
                pr += `<td style="background:#f5f5f5;padding:9px">Location</td>`;
                }
                if(cols?.eta){
                pr += `<td style="background:#f5f5f5;padding:9px">ETA</td>`;
                } 
                if(cols?.wkrno){
                pr += `<td style="background:#f5f5f5;padding:9px">Work order Ref#</td>`;
                } 
                if(cols?.area){
                pr += `<td style="background:#f5f5f5;padding:9px">SQM</td>`;
                }
                if(cols?.unitprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Unit Price</td>`;                
                } 
                if(cols?.otherprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Other Price</td>`;                
                }  
                if(cols?.totalprice){
                pr += `<td style="background:#f5f5f5;padding:9px">Total Price</td>`;                
                }                
                    pr += `</tr>`
                    pr += "<header>"
                    pr += "<tr>";
                    pr +=`<td colspan="28" style="background: #e9fcff;font-weight: 600;font-size: 0.95rem;padding: 6px;">${x.gbyname}</td>`;
                    pr += "<tr>";
                    pr += "</header> <tbody>"
                    x.data.map((i,index)=>{
                    pr += `<tr key=${index}>`;
                        pr += `<td>${index+1}</td>`
                        if(cols?.odate){
                        pr += `<td>${i.procurement_orderdate_d.display}</td>`
                        }
                        if(cols?.otype){
                        pr += `<td>${i.goreceipttype}</td>`
                        }
                        if(cols?.supplier){
                        pr += `<td>${i.procurement_supplier}</td>`;
                        }
                        if(cols?.coatting){
                            pr += `<td>${i.procurement_coating}</td>`;
                        }
                        if(cols?.contract){
                            pr += `<td>${i.goproject}</td>`
                        }
                        if(cols?.projectname){     
                        pr += `<td>${i.goprojectname}</td>`
                        }
                        if(cols?.gono){   
                        pr += `<td>${i.gonodisp}</td>`
                        }      
                        if(cols?.pino){
                            pr += `<td>${i.invoiceno}</td>`
                        }                 
                        if(cols?.thikenss){
                            pr += `<td>${i.procurement_thickness}</td>`;
                        }                       
                        if(cols?.outter){
                            pr += `<td>${i.procurement_out}</td>`;
                        }
                        if(cols?.inner){
                            pr += `<td>${i.procurement_inner}</td>`;
                        }

                        if(cols?.qty){
                            pr += `<td style="text-align:center">${i.procurement_qty}</td>`;
                        }
                        if(cols?.qtyreceived){
                            pr += `<td style="text-align:center">${i.receipt_qty}</td>`;
                        }
                        if(cols?.qtybalance){
                            pr += `<td style="text-align:center">${i.go_balance_qty}</td>`;
                        }
                        if(cols?.uinsert){
                            pr += `<td style="text-align:center">${i.uinsert}</td>`;
                        }
                        if(cols?.remarks){ 
                            pr += `<td style="text-align:center">${i.procurementremark}</td>`;
                        }
                        if(cols?.dlocation){ 
                            pr += `<td style="text-align:center">${i.dellocation}</td>`;
                        }
                        if(cols?.eta){
                            pr += `<td>${i.procurement_orderdate}</td>`;
                        }
                        if(cols?.wkrno){ 
                            pr += `<td style="text-align:center">${i.workorderno}</td>`;
                        }

                        if(cols?.area){
                            pr += `<td style="text-align:center">${(+i.procurement_area).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }                       
                       
                        if(cols?.unitprice){
                            pr += `<td style="text-align:right">${(+i.procurment_orderunitprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;   
                        }  
                        if(cols?.otherprice){
                            pr += `<td style="text-align:right">${(+i.procurement_otherprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;             
                        }  
                        if(cols?.totalprice){
                            pr += `<td style="text-align:right">${(+i.procurement_totalprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }     
                    pr += `</tr>`;

                })
                pr += `<tr>`;
                        pr += `<td style="background: #e5fff7"></td>`
                        if(cols?.odate){
                        pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.otype){
                        pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.supplier){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.coatting){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.contract){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.projectname){
                        pr += `<td style="background: #e5fff7;"></td>`;
                        }
                        if(cols?.gono){
                        pr += `<td style="background: #e5fff7;"></td>`;
                        }     
                        if(cols?.pino){
                        pr += `<td style="background: #e5fff7;"></td>`;
                        }                     
                        if(cols?.thikenss){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.outter){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.inner){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        
                        if(cols?.qty){
                            pr += `<td style="background: #e5fff7;font-weight:bold;color:red;text-align:center">${(+x.totqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.qtyreceived){
                            pr += `<td style="background: #e5fff7;font-weight:bold;color:red;text-align:center">${(+x.recqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.qtybalance){
                            pr += `<td style="background: #e5fff7;font-weight:bold;color:red;text-align:center">${(+x.balqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.uinsert){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.remarks){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.dlocation){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.eta){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.wkrno){
                            pr += `<td style="background: #e5fff7"></td>`;
                        }
                        if(cols?.area){
                            pr += `<td style="background: #e5fff7;font-weight:bold;color:red;text-align:center">${(+x.totarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        } 
                        if(cols?.unitprice){
                            pr += `<td style="background: #e5fff7"></td>`;   
                        }  
                        if(cols?.otherprice){
                            pr += `<td style="background: #e5fff7"></td>`;             
                        }  
                        if(cols?.totalprice){
                            pr += `<td style="background: #e5fff7;ont-weight:bold;color:red;text-align:center">${(+x.totprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }  
                pr += `<tr>`;
            })
                //sum of table rows need
                pr += `<tr>`;
                        pr += `<td style="background: #fdffe5;"></td>`
                        if(cols?.odate){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.otype){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.supplier){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.coatting){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.contract){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.projectname){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.gono){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.pino){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.thikenss){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.outter){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.inner){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }                        
                        if(cols?.qty){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }                        
                        if(cols?.qtyreceived){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(grecqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }                        
                        if(cols?.qtybalance){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gbalqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.uinsert){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        } 
                        if(cols?.remarks){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        }  
                        if(cols?.dlocation){
                        pr += `<td style="background: #fdffe5;"></td>`;
                        } 
                        if(cols?.eta){
                            pr += `<td style="background: #fdffe5;"></td>`;
                        }
                        if(cols?.wkrno){
                            pr += `<td style="background: #fdffe5;"></td>`;
                        }
                           
                        if(cols?.area){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        } 
                        if(cols?.unitprice){
                            pr += `<td style="background: #fdffe5;"></td>`;   
                        }  
                        if(cols?.otherprice){
                            pr += `<td style="background: #fdffe5;"></td>`;             
                        }  
                        if(cols?.totalprice){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }  
                pr += `<tr>`;
                //sum of table rows need end
                pr +=`</tbody></table>`;
                document.getElementById("maincontent").innerHTML = pr;
            }

            //group and summary for group print;
            function printsummary(){
                let pr = "";
                pr += ` <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th colspan="20"
                                    style="align-items: center;background-color: #ffffff;
                                border-right: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                ">
                                    <img load="lazy" src="./css/nafco_letter.png"
                                        style="width:90%;height: 88px;">
                                </th>
                            </tr>
                            <tr>
                                <th id="pagetitlex" colspan="15" style="font-size: 18px;
                                border-right: 1px solid transparent;
                                border-bottom: 1px solid transparent;
                                border-top: 1px solid transparent;
                                border-left: 1px solid transparent;
                                border-left: 1px solid transparent;
                            ">
                                    GLASS ORDER REPORT ${gorupbytitle}
                                </th>
                            </tr>
                        </thead>
                        </table>
                        <table style="width: 100%;">      
                            <thead>
                                <tr>`
                                    pr += `<td style="background:#f5f5f5;padding:9px"> S.No </td>`;                
                                    pr += `<td style="background:#f5f5f5;padding:9px"> Project </td>`;
                                    if(cols?.qty){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> Qty </td>`;
                                    }
                                    if(cols?.area){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> Area </td>`;
                                    }
                                    if(cols?.qtyreceived){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> R.Qty </td>`;
                                    }
                                    if(cols?.areareceived){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> R.Area </td>`;
                                    }
                                    if(cols?.qtybalance){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> B.Qty </td>`;
                                    }
                                    if(cols?.areabalance){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> B.Area </td>`;
                                    }
                                    if(cols?.totalprice){
                                    pr += `<td style="background:#f5f5f5;padding:9px"> Total Price </td>`;                
                                    }  
                          pr += ` </tr>
                            </thead>  
                            <tbody>              
                            `
                gdata.map((i,index)=>{
                    pr += `<tr>`;
                        pr += `<td>${index+1}</td>`;
                        pr += `<td>${i.gbyname}</td>`;
                        if(cols?.qty){
                            pr += `<td style="text-align:center">${(+i.totqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.area){
                            pr += `<td style="text-align:center">${(+i.totarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.qtyreceived){
                            pr += `<td style="text-align:center">${(+i.recqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.areareceived){
                            pr += `<td style="text-align:center">${(+i.recarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.qtybalance){
                            pr += `<td style="text-align:center">${(+i.balqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.areabalance){
                            pr += `<td style="text-align:center">${(+i.balarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.totalprice){
                            pr += `<td style="text-align:center">${(+i.totprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }
                pr += `</tr>`;  
                })
                pr += `<tr>`;
                        pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center"></td>`;
                        pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">Grand Total</td>`;
                        if(cols?.qty){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.area){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.qtyreceived){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(grecqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.areareceived){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+grecarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.qtybalance){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gbalqty).toLocaleString(undefined,{maximumFractionDigits:0})}</td>`;
                        }
                        if(cols?.areabalance){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(gbalarea).toLocaleString(undefined,{maximumFractionDigits:3})}</td>`;
                        }
                        if(cols?.totalprice){
                            pr += `<td style="background: #fdffe5;font-weight:bold;color:red;text-align:center">${(+gtotprice).toLocaleString(undefined,{maximumFractionDigits:2})}</td>`;           
                        }
                pr += `</tr>`;   
                document.getElementById("maincontent").innerHTML = pr;
            }
        </script>
        <script>
             $("#exportexcel").click(function() {
                console.log("working")
        $("#maincontent").table2excel({
            // exclude CSS class
            exclude: ".noExl",
            name: "Worksheet Name",
            filename: "SomeFile", //do not include extension
            fileext: ".xls" // file extension
        });
    });
        </script>
    </body>
</html>
